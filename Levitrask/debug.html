<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Levitrask Debug Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .debug-panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #0056b3;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .log-entry {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 10px;
            margin: 5px 0;
            font-family: monospace;
            font-size: 12px;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Levitrask Debug Tool</h1>
    
    <div class="debug-panel">
        <h2>Quick Tests</h2>
        <button class="button" onclick="testLanguageSwitch()">Test Language Switch</button>
        <button class="button" onclick="testRouteNavigation()">Test Route Navigation</button>
        <button class="button" onclick="testLocalStorage()">Test LocalStorage</button>
        <button class="button" onclick="clearDebugData()">Clear Debug Data</button>
    </div>

    <div class="debug-panel">
        <h2>Application Status</h2>
        <div id="app-status"></div>
        <button class="button" onclick="checkStatus()">Refresh Status</button>
    </div>

    <div class="debug-panel">
        <h2>Test Results</h2>
        <div id="test-results"></div>
    </div>

    <div class="debug-panel">
        <h2>Debug Logs</h2>
        <div id="debug-logs"></div>
        <button class="button" onclick="exportLogs()">Export Logs</button>
    </div>

    <script>
        function log(message, type = 'info') {
            const logsDiv = document.getElementById('debug-logs');
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong> [${type.toUpperCase()}] ${message}`;
            logsDiv.appendChild(logEntry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('app-status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function showTestResult(test, result, details = '') {
            const resultsDiv = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `status ${result ? 'success' : 'error'}`;
            resultDiv.innerHTML = `<strong>${test}:</strong> ${result ? 'PASS' : 'FAIL'} ${details}`;
            resultsDiv.appendChild(resultDiv);
        }

        function testLanguageSwitch() {
            log('Testing language switch functionality...');
            
            // Test localStorage
            const originalLang = localStorage.getItem('user-locale');
            localStorage.setItem('user-locale', 'zh-CN');
            const testLang = localStorage.getItem('user-locale');
            
            showTestResult('LocalStorage Language', testLang === 'zh-CN', `Set: zh-CN, Got: ${testLang}`);
            
            // Restore original
            if (originalLang) {
                localStorage.setItem('user-locale', originalLang);
            } else {
                localStorage.removeItem('user-locale');
            }
            
            log('Language switch test completed');
        }

        function testRouteNavigation() {
            log('Testing route navigation...');
            
            const currentUrl = window.location.href;
            const hasLangPrefix = /\/(en|zh-CN|ru)\//.test(currentUrl);
            
            showTestResult('URL Language Prefix', hasLangPrefix, `URL: ${currentUrl}`);
            
            log('Route navigation test completed');
        }

        function testLocalStorage() {
            log('Testing localStorage functionality...');
            
            try {
                const testKey = 'levitrask-test';
                const testValue = 'test-value-' + Date.now();
                
                localStorage.setItem(testKey, testValue);
                const retrieved = localStorage.getItem(testKey);
                localStorage.removeItem(testKey);
                
                showTestResult('LocalStorage Read/Write', retrieved === testValue, `Expected: ${testValue}, Got: ${retrieved}`);
            } catch (error) {
                showTestResult('LocalStorage Read/Write', false, `Error: ${error.message}`);
            }
            
            log('LocalStorage test completed');
        }

        function checkStatus() {
            log('Checking application status...');
            
            const status = {
                url: window.location.href,
                userAgent: navigator.userAgent,
                localStorage: {
                    userLocale: localStorage.getItem('user-locale'),
                    debugMode: localStorage.getItem('debug-mode')
                },
                timestamp: new Date().toISOString()
            };
            
            showStatus(`<pre>${JSON.stringify(status, null, 2)}</pre>`, 'success');
            log('Status check completed');
        }

        function clearDebugData() {
            localStorage.removeItem('user-locale');
            localStorage.removeItem('debug-mode');
            document.getElementById('debug-logs').innerHTML = '';
            document.getElementById('test-results').innerHTML = '';
            document.getElementById('app-status').innerHTML = '';
            log('Debug data cleared');
        }

        function exportLogs() {
            const logs = document.getElementById('debug-logs').innerText;
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `levitrask-debug-${Date.now()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            log('Logs exported');
        }

        // Initialize
        log('Debug tool initialized');
        checkStatus();
    </script>
</body>
</html>
